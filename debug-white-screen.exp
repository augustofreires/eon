#!/usr/bin/expect -f

set timeout 30

spawn ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@31.97.28.231
expect "password:"
send "62uDLW4RJ9ae28EPVfp5yzT##\r"
expect "#"

send "echo '🔍 DEBUGGING WHITE SCREEN ISSUE...'\r"
expect "#"

send "echo '📊 Checking if main JS file is accessible:'\r"
expect "#"

send "curl -I http://localhost/static/js/main.8e41c41e.js | head -5\r"
expect "#"

send "echo '📋 Checking Nginx error logs:'\r"
expect "#"

send "tail -20 /var/log/nginx/error.log\r"
expect "#"

send "echo '📋 Checking backend logs:'\r"
expect "#"

send "pm2 logs iaeon-server --lines 10\r"
expect "#"

send "echo '📁 Checking file exists and permissions:'\r"
expect "#"

send "ls -la /var/www/html/static/js/main*\r"
expect "#"

send "echo '🔍 Testing if index.html references correct JS file:'\r"
expect "#"

send "grep -o 'main\\.[a-z0-9]*\\.js' /var/www/html/index.html | head -3\r"
expect "#"

send "echo '🔧 Browser console would show exact error - lets check file syntax:'\r"
expect "#"

send "node -c /var/www/html/static/js/main.8e41c41e.js && echo 'JS syntax OK' || echo 'JS syntax ERROR'\r"
expect "#"

send "exit\r"
expect eof