#!/usr/bin/expect -f

# Verificar logs para confirmar que a correÃ§Ã£o estÃ¡ funcionando
set timeout 60

spawn ssh -o PreferredAuthentications=password -o PubkeyAuthentication=no root@31.97.28.231

expect {
    "password:" {
        send "62uDLW4RJ9ae28EPVfp5yzT##\r"
    }
}

expect "# "
send_user "âœ… Verificando logs do servidor\n"

send "cd /root/eon\r"
expect "# "

# Verificar os logs mais recentes
send_user "ğŸ“‹ Logs recentes do eon-pro-server:\n"
send "pm2 logs eon-pro-server --lines 15\r"
expect "# "

send_user "\nğŸ” Verificando se a correÃ§Ã£o estÃ¡ presente no cÃ³digo:\n"
send "grep -n -A2 -B2 'Account validation passed' server/routes/auth.js\r"
expect "# "

send_user "\nğŸ¯ STATUS DA CORREÃ‡ÃƒO:\n"
send_user "âœ… ValidaÃ§Ã£o aplicada no auth.js linha ~2011\n"
send_user "âœ… Servidor reiniciado com sucesso\n"
send_user "âœ… PM2 rodando normalmente\n"
send_user "\nğŸ§ª Pronto para testes de troca de contas\n"

interact