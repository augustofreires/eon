#!/usr/bin/expect -f

set timeout 60

spawn ssh -o PreferredAuthentications=password -o PubkeyAuthentication=no root@31.97.28.231

expect {
   "password:" {
       send "62uDLW4RJ9ae28EPVfp5yzT##\r"
   }
}

expect "# "
send_user "ðŸš€ FINALIZANDO DEPLOY...\n"

send "cd /root/eon/client\r"
expect "# "

send_user "ðŸ“‚ Copiando build para nginx...\n"
send "cp -r build/* /usr/share/nginx/html/\r"
expect "# "

send_user "ðŸ”„ Reiniciando servidor...\n"
send "cd /root/eon\r"
expect "# "

send "pm2 restart eon-pro-server\r"
expect "# "

send_user "\nâœ… CORREÃ‡ÃƒO COMPLETA DEPLOYADA!\n"
send_user "\nðŸ”§ CORREÃ‡Ã•ES APLICADAS:\n"
send_user "   âœ… Backend: /get-token retorna token especÃ­fico\n"
send_user "   âœ… Backend: Account mismatch bypass ativo\n"
send_user "   âœ… Frontend: WebSocket reconecta com token correto\n"
send_user "   âœ… Frontend: Balance atualiza apÃ³s switch\n"
send_user "\nðŸ§ª TESTE FINAL:\n"
send_user "   1. Abra https://iaeon.site/operations\n"
send_user "   2. Troque de conta (qualquer uma)\n"
send_user "   3. BALANCE DEVE ATUALIZAR EM 3-5 SEGUNDOS! âœ¨\n"

interact
