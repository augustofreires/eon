#!/usr/bin/expect -f

set timeout 60

spawn ssh -o PreferredAuthentications=password -o PubkeyAuthentication=no root@31.97.28.231

expect {
    "password:" {
        send "62uDLW4RJ9ae28EPVfp5yzT##\r"
    }
}

expect "# "
send "cd /root/eon\r"
expect "# "

send_user "ğŸ” VERIFICANDO SE A CORREÃ‡ÃƒO ESTÃ NO ARQUIVO auth.js...\n"

# Verificar se nossa correÃ§Ã£o estÃ¡ no arquivo
send "grep -A10 -B5 'CRITICAL.*Getting token for current account' server/routes/auth.js\r"
expect "# "

send_user "\nğŸ” Verificando se encontra o endpoint get-token:\n"
send "grep -A15 -B5 'get-token.*authenticateToken' server/routes/auth.js\r"
expect "# "

send_user "\nğŸ” Verificando data de modificaÃ§Ã£o do arquivo:\n"
send "ls -la server/routes/auth.js\r"
expect "# "

send_user "\nğŸ”„ Se a correÃ§Ã£o nÃ£o estiver lÃ¡, vamos reaplicar...\n"

interact