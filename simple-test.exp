#!/usr/bin/expect -f
set timeout 30

spawn ssh -o StrictHostKeyChecking=no root@31.97.28.231
expect {
    "password:" {
        send "iaeon2024@\r"
        exp_continue
    }
    "Permission denied" {
        send_user "Primeira senha falhou, tentando segunda...\n"
        spawn ssh -o StrictHostKeyChecking=no root@31.97.28.231
        expect "password:"
        send "Eonpro@2024\r"
        exp_continue
    }
    "#" {
        send_user "Login bem-sucedido!\n"
    }
}

expect "#"
send "cd /root/eon && pwd && ls -la\r"
expect "#"

send "pm2 status\r"
expect "#"

send "curl -s -X POST http://localhost:3001/api/login -H \"Content-Type: application/json\" -d '{\"email\":\"cliente@iaeon.com\",\"password\":\"123456\"}' | head -10\r"
expect "#"

send "exit\r"
expect eof
