#!/usr/bin/expect -f

set timeout 60

spawn ssh -o PreferredAuthentications=password -o PubkeyAuthentication=no root@31.97.28.231

expect {
    "password:" {
        send "62uDLW4RJ9ae28EPVfp5yzT##\r"
    }
}

expect "# "
send_user "ğŸ”§ Corrigindo conflito de porta...\n"

send "cd /root/eon\r"
expect "# "

send_user "â¹ï¸ Parando servidor duplicado...\n"
send "pm2 stop server\r"
expect "# "

send "pm2 delete server\r"
expect "# "

send_user "ğŸ”„ Reiniciando servidor principal com correÃ§Ã£o...\n"
send "pm2 restart eon-pro-server\r"
expect "# "

send_user "ğŸ“‹ Status final:\n"
send "pm2 list\r"
expect "# "

send_user "ğŸ“‹ Verificando logs do servidor principal:\n"
send "pm2 logs eon-pro-server --lines 10\r"
expect "# "

send_user "âœ… Conflito de porta resolvido! Agora teste novamente.\n"

interact